Детектор сцен с помощью векторного представления кадров.

Для разбивки не столько по изменениям в кадре, сколько по изменению "смысла" кадра возникла необходимость в данном детекторе сцен.
Качество разбивки всецело зависит от качества обученной нейронной сети, с помощью которой генерятся вектора.

Этапы обработки следующие:

1) Из видео, покадрово, строится массив векторных представлений. NxV
2) Вычисляется попарная дистанция между кадрами видео. В этом случае не полная, а в рамках окна. NxW
3) Вычисляется суммарная дистанция для каждой возможной сцены и её площадь. Формируется матрица стоимостей (дистанция/площадь) возможных сцен. NxW
4) Формируем множество оптимальных разбивок сцен. Предполагая, что каждый кадр - сцена, итеративно, объединяем соседние сцены с минимальной стоимостью объединенной сцены. Делаем это пока есть возможность объединять (у нас есть органичитель в виде окна, больше которого сцену не сделать). В итоге получаем набор разбивок на сцены с разницей в одну сцену.
5) Выбираем оптимальную разбивку. Наверное это должен быть локоть. Пока просто выбираем сцену, которая переходит порог суммарной стоимость вариантов (от стоимости всех возможных разбивок).


